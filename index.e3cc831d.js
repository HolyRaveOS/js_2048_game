new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){console.log(t),this.board=t,this.size=t.length,this.fieldsRows=this.getFieldsRows(),this.currentScore=0,this.currentScoreElement=document.querySelector(".game-score"),this.loseMessage=document.querySelector(".message-lose"),this.winMessage=document.querySelector(".message-win"),this.startMessage=document.querySelector(".message-start"),this.gameStatus="idle"}moveLeft(){this.move("ArrowLeft")}moveRight(){this.move("ArrowRight")}moveUp(){this.move("ArrowUp")}moveDown(){this.move("ArrowDown")}getScore(){return this.currentScore}getState(){return this.board}getStatus(){return this.gameStatus}start(){this.fillRandomEmptyCell(),this.fillRandomEmptyCell();let t=document.querySelector(".start");this.startBtn=t,addEventListener("keydown",t=>{switch(t.key){case"ArrowRight":this.moveRight();break;case"ArrowLeft":this.moveLeft();break;case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown()}}),t.addEventListener("click",()=>{t.classList.contains("start")?(this.gameStatus="playing",this.menageStates()):this.restart()})}restart(){this.board.forEach((t,e)=>{t.forEach((t,s)=>{this.board[e][s]=0})}),this.updateField(),this.gameStatus="idle",this.fillRandomEmptyCell(),this.fillRandomEmptyCell(),this.menageStates()}menageStates(){switch(this.gameStatus){case"idle":this.currentScore=0,this.currentScoreElement.innerHTML=this.currentScore,this.startBtn.className="button start",this.startBtn.innerHTML="Start",this.loseMessage.classList.add("hidden"),this.winMessage.classList.add("hidden"),this.startMessage.classList.remove("hidden");break;case"playing":this.startBtn.style.pointerEvents="none",this.startMessage.classList.add("hidden");break;case"win":this.winMessage.classList.remove("hidden");break;case"lose":this.loseMessage.classList.remove("hidden");break;default:throw Error("Something went wrong")}}move(t){let e=!1;if(this.gameStatus="playing",this.menageStates(),this.startBtn.className="button restart",this.startBtn.innerHTML="Restart",this.startBtn.style.pointerEvents="initial",this.checkIfTheGameOver(),"ArrowUp"===t||"ArrowDown"===t)for(let s=0;s<this.size;s++){let i=[...Array(this.size)].map((t,e)=>this.board[e][s]),r=this.transformField(i,"ArrowUp"===t);for(let t=0;t<this.size;t++)this.board[t][s]!==r[t]&&(e=!0,this.board[t][s]=r[t])}else if("ArrowLeft"===t||"ArrowRight"===t)for(let s=0;s<this.size;s++){let i=this.board[s],r=this.transformField(i,"ArrowLeft"===t);i.join(",")!==r.join(",")&&(e=!0,this.board[s]=r)}e&&this.fillRandomEmptyCell()}checkIfTheGameOver(){for(let t=0;t<this.size;t++)for(let e=0;e<this.size;e++)if(0===this.board[t][e]||e<this.size-1&&this.board[t][e]===this.board[t][e+1]||t<this.size-1&&this.board[t][e]===this.board[t+1][e])return;this.gameStatus="lose",this.menageStates()}transformField(t,e){let s=t.filter(t=>0!==t);e||s.reverse();for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.updateScore(s[t]),s.splice(t+1,1));for(;s.length<this.size;)s.push(0);return e||s.reverse(),s}updateField(){this.fieldsRows.forEach((t,e)=>{t.forEach((t,s)=>{t.innerHTML=0===this.board[e][s]?"":this.board[e][s],t.className=`field-cell field-cell--${this.board[e][s]}`})})}getFieldsRows(){let t=[];return document.querySelectorAll(".field-row").forEach(e=>{t.push(Array.from(e.childNodes).filter(t=>t.nodeType===Node.ELEMENT_NODE))}),t}updateScore(t){2048===t&&(this.gameStatus="win",this.menageStates()),this.currentScore+=t,this.currentScoreElement.innerHTML=this.currentScore}fillRandomEmptyCell(){let t=[];for(let e=0;e<this.size;e++)for(let s=0;s<this.size;s++)0===this.board[e][s]&&t.push({x:e,y:s});if(t.length>0){let e=t[Math.floor(Math.random()*t.length)];this.board[e.x][e.y]=.9>Math.random()?2:4,this.updateField(),this.toggleAnimationClass(this.fieldsRows[e.x][e.y])}}toggleAnimationClass(t){t.classList.add("new-title"),setTimeout(()=>{t.classList.remove("new-title")},300)}}().start();
//# sourceMappingURL=index.e3cc831d.js.map
