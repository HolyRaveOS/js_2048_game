!function(){function e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=Array(t);r<t;r++)s[r]=e[r];return s}new(function(){var r,s;function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i),console.log(e),this.board=e,this.size=e.length,this.fieldsRows=this.getFieldsRows(),this.currentScore=0,this.currentScoreElement=document.querySelector(".game-score"),this.loseMessage=document.querySelector(".message-lose"),this.winMessage=document.querySelector(".message-win"),this.startMessage=document.querySelector(".message-start"),this.gameStatus="idle"}return r=[{key:"moveLeft",value:function(){this.move("ArrowLeft")}},{key:"moveRight",value:function(){this.move("ArrowRight")}},{key:"moveUp",value:function(){this.move("ArrowUp")}},{key:"moveDown",value:function(){this.move("ArrowDown")}},{key:"getScore",value:function(){return this.currentScore}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.gameStatus}},{key:"start",value:function(){var e=this;this.fillRandomEmptyCell(),this.fillRandomEmptyCell();var t=document.querySelector(".start");this.startBtn=t,addEventListener("keydown",function(t){switch(t.key){case"ArrowRight":e.moveRight();break;case"ArrowLeft":e.moveLeft();break;case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown()}}),t.addEventListener("click",function(){t.classList.contains("start")?(e.gameStatus="playing",e.menageStates()):e.restart()})}},{key:"restart",value:function(){var e=this;this.board.forEach(function(t,r){t.forEach(function(t,s){e.board[r][s]=0})}),this.updateField(),this.gameStatus="idle",this.fillRandomEmptyCell(),this.fillRandomEmptyCell(),this.menageStates()}},{key:"menageStates",value:function(){switch(this.gameStatus){case"idle":this.currentScore=0,this.currentScoreElement.innerHTML=this.currentScore,this.startBtn.className="button start",this.startBtn.innerHTML="Start",this.loseMessage.classList.add("hidden"),this.winMessage.classList.add("hidden"),this.startMessage.classList.remove("hidden");break;case"playing":this.startBtn.style.pointerEvents="none",this.startMessage.classList.add("hidden");break;case"win":this.winMessage.classList.remove("hidden");break;case"lose":this.loseMessage.classList.remove("hidden");break;default:throw Error("Something went wrong")}}},{key:"move",value:function(e){var r=this,s=function(s){for(var a,o=((function(e){if(Array.isArray(e))return t(e)})(a=Array(r.size))||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,r){if(e){if("string"==typeof e)return t(e,r);var s=Object.prototype.toString.call(e).slice(8,-1);if("Object"===s&&e.constructor&&(s=e.constructor.name),"Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return t(e,r)}}(a)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map(function(e,t){return i.board[t][s]}),l=r.transformField(o,"ArrowUp"===e),c=0;c<r.size;c++)r.board[c][s]!==l[c]&&(n=!0,r.board[c][s]=l[c])},i=this,n=!1;if(this.gameStatus="playing",this.menageStates(),this.startBtn.className="button restart",this.startBtn.innerHTML="Restart",this.startBtn.style.pointerEvents="initial",this.checkIfTheGameOver(),"ArrowUp"===e||"ArrowDown"===e)for(var a=0;a<this.size;a++)s(a);else if("ArrowLeft"===e||"ArrowRight"===e)for(var o=0;o<this.size;o++){var l=this.board[o],c=this.transformField(l,"ArrowLeft"===e);l.join(",")!==c.join(",")&&(n=!0,this.board[o]=c)}n&&this.fillRandomEmptyCell()}},{key:"checkIfTheGameOver",value:function(){for(var e=0;e<this.size;e++)for(var t=0;t<this.size;t++)if(0===this.board[e][t]||t<this.size-1&&this.board[e][t]===this.board[e][t+1]||e<this.size-1&&this.board[e][t]===this.board[e+1][t])return;this.gameStatus="lose",this.menageStates()}},{key:"transformField",value:function(e,t){var r=e.filter(function(e){return 0!==e});t||r.reverse();for(var s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,this.updateScore(r[s]),r.splice(s+1,1));for(;r.length<this.size;)r.push(0);return t||r.reverse(),r}},{key:"updateField",value:function(){var e=this;this.fieldsRows.forEach(function(t,r){t.forEach(function(t,s){t.innerHTML=0===e.board[r][s]?"":e.board[r][s],t.className="field-cell field-cell--".concat(e.board[r][s])})})}},{key:"getFieldsRows",value:function(){var e=[];return document.querySelectorAll(".field-row").forEach(function(t){e.push(Array.from(t.childNodes).filter(function(e){return e.nodeType===Node.ELEMENT_NODE}))}),e}},{key:"updateScore",value:function(e){2048===e&&(this.gameStatus="win",this.menageStates()),this.currentScore+=e,this.currentScoreElement.innerHTML=this.currentScore}},{key:"fillRandomEmptyCell",value:function(){for(var e=[],t=0;t<this.size;t++)for(var r=0;r<this.size;r++)0===this.board[t][r]&&e.push({x:t,y:r});if(e.length>0){var s=e[Math.floor(Math.random()*e.length)];this.board[s.x][s.y]=.9>Math.random()?2:4,this.updateField(),this.toggleAnimationClass(this.fieldsRows[s.x][s.y])}}},{key:"toggleAnimationClass",value:function(e){e.classList.add("new-title"),setTimeout(function(){e.classList.remove("new-title")},300)}}],e(i.prototype,r),s&&e(i,s),i}())().start()}();
//# sourceMappingURL=index.257b7c8f.js.map
